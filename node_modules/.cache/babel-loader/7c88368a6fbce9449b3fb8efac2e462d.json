{"ast":null,"code":"/**\r\n * The code in the <project-logo></project-logo> area\r\n * must not be changed.\r\n *\r\n * @see http://bpmn.io/license for more information.\r\n */\nimport { assign, find, isNumber, omit } from 'min-dash';\nimport { domify, query as domQuery, remove as domRemove } from 'min-dom';\nimport { innerSVG } from 'tiny-svg';\nimport Diagram from 'diagram-js';\nimport BpmnModdle from 'bpmn-moddle';\nimport inherits from 'inherits';\nimport { importBpmnDiagram } from './import/Importer';\nimport { wrapForCompatibility } from './util/CompatibilityUtil';\n\n/**\r\n * A base viewer for BPMN 2.0 diagrams.\r\n *\r\n * Have a look at {@link Viewer}, {@link NavigatedViewer} or {@link Modeler} for\r\n * bundles that include actual features.\r\n *\r\n * @param {Object} [options] configuration options to pass to the viewer\r\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\r\n * @param {string|number} [options.width] the width of the viewer\r\n * @param {string|number} [options.height] the height of the viewer\r\n * @param {Object} [options.moddleExtensions] extension packages to provide\r\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\r\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\r\n */\nexport default function BaseViewer(options) {\n  options = assign({}, DEFAULT_OPTIONS, options);\n  this._moddle = this._createModdle(options);\n  this._container = this._createContainer(options);\n\n  /* <project-logo> */\n\n  addProjectLogo(this._container);\n\n  /* </project-logo> */\n\n  this._init(this._container, this._moddle, options);\n}\ninherits(BaseViewer, Diagram);\n\n/**\r\n* The importXML result.\r\n*\r\n* @typedef {Object} ImportXMLResult\r\n*\r\n* @property {Array<string>} warnings\r\n*/\n\n/**\r\n* The importXML error.\r\n*\r\n* @typedef {Error} ImportXMLError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\n\n/**\r\n * Parse and render a BPMN 2.0 diagram.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During import the viewer will fire life-cycle events:\r\n *\r\n *   * import.parse.start (about to read model from xml)\r\n *   * import.parse.complete (model read; may have worked or not)\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *   * import.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {string} xml the BPMN 2.0 xml\r\n * @param {ModdleElement<BPMNDiagram>|string} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\r\n *\r\n * Returns {Promise<ImportXMLResult, ImportXMLError>}\r\n */\nBaseViewer.prototype.importXML = wrapForCompatibility(function importXML(xml, bpmnDiagram) {\n  var self = this;\n  function ParseCompleteEvent(data) {\n    var event = self.get('eventBus').createEvent(data);\n\n    // TODO(nikku): remove with future bpmn-js version\n    Object.defineProperty(event, 'context', {\n      enumerable: true,\n      get: function () {\n        console.warn(new Error('import.parse.complete <context> is deprecated ' + 'and will be removed in future library versions'));\n        return {\n          warnings: data.warnings,\n          references: data.references,\n          elementsById: data.elementsById\n        };\n      }\n    });\n    return event;\n  }\n  return new Promise(function (resolve, reject) {\n    // hook in pre-parse listeners +\n    // allow xml manipulation\n    xml = self._emit('import.parse.start', {\n      xml: xml\n    }) || xml;\n    self._moddle.fromXML(xml, 'bpmn:Definitions').then(function (result) {\n      var definitions = result.rootElement;\n      var references = result.references;\n      var parseWarnings = result.warnings;\n      var elementsById = result.elementsById;\n\n      // hook in post parse listeners +\n      // allow definitions manipulation\n      definitions = self._emit('import.parse.complete', ParseCompleteEvent({\n        error: null,\n        definitions: definitions,\n        elementsById: elementsById,\n        references: references,\n        warnings: parseWarnings\n      })) || definitions;\n      self.importDefinitions(definitions, bpmnDiagram).then(function (result) {\n        var allWarnings = [].concat(parseWarnings, result.warnings || []);\n        self._emit('import.done', {\n          error: null,\n          warnings: allWarnings\n        });\n        return resolve({\n          warnings: allWarnings\n        });\n      }).catch(function (err) {\n        var allWarnings = [].concat(parseWarnings, err.warnings || []);\n        self._emit('import.done', {\n          error: err,\n          warnings: allWarnings\n        });\n        return reject(addWarningsToError(err, allWarnings));\n      });\n    }).catch(function (err) {\n      self._emit('import.parse.complete', {\n        error: err\n      });\n      err = checkValidationError(err);\n      self._emit('import.done', {\n        error: err,\n        warnings: err.warnings\n      });\n      return reject(err);\n    });\n  });\n});\n\n/**\r\n* The importDefinitions result.\r\n*\r\n* @typedef {Object} ImportDefinitionsResult\r\n*\r\n* @property {Array<string>} warnings\r\n*/\n\n/**\r\n* The importDefinitions error.\r\n*\r\n* @typedef {Error} ImportDefinitionsError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\n\n/**\r\n * Import parsed definitions and render a BPMN 2.0 diagram.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During import the viewer will fire life-cycle events:\r\n *\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {ModdleElement<Definitions>} definitions parsed BPMN 2.0 definitions\r\n * @param {ModdleElement<BPMNDiagram>|string} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\r\n *\r\n * Returns {Promise<ImportDefinitionsResult, ImportDefinitionsError>}\r\n */\nBaseViewer.prototype.importDefinitions = wrapForCompatibility(function importDefinitions(definitions, bpmnDiagram) {\n  var self = this;\n  return new Promise(function (resolve, reject) {\n    self._setDefinitions(definitions);\n    self.open(bpmnDiagram).then(function (result) {\n      var warnings = result.warnings;\n      return resolve({\n        warnings: warnings\n      });\n    }).catch(function (err) {\n      return reject(err);\n    });\n  });\n});\n\n/**\r\n * The open result.\r\n *\r\n * @typedef {Object} OpenResult\r\n *\r\n * @property {Array<string>} warnings\r\n */\n\n/**\r\n* The open error.\r\n*\r\n* @typedef {Error} OpenError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\n\n/**\r\n * Open diagram of previously imported XML.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During switch the viewer will fire life-cycle events:\r\n *\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {string|ModdleElement<BPMNDiagram>} [bpmnDiagramOrId] id or the diagram to open\r\n *\r\n * Returns {Promise<OpenResult, OpenError>}\r\n */\nBaseViewer.prototype.open = wrapForCompatibility(function open(bpmnDiagramOrId) {\n  var definitions = this._definitions;\n  var bpmnDiagram = bpmnDiagramOrId;\n  var self = this;\n  return new Promise(function (resolve, reject) {\n    if (!definitions) {\n      var err1 = new Error('no XML imported');\n      return reject(addWarningsToError(err1, []));\n    }\n    if (typeof bpmnDiagramOrId === 'string') {\n      bpmnDiagram = findBPMNDiagram(definitions, bpmnDiagramOrId);\n      if (!bpmnDiagram) {\n        var err2 = new Error('BPMNDiagram <' + bpmnDiagramOrId + '> not found');\n        return reject(addWarningsToError(err2, []));\n      }\n    }\n\n    // clear existing rendered diagram\n    // catch synchronous exceptions during #clear()\n    try {\n      self.clear();\n    } catch (error) {\n      return reject(addWarningsToError(error, []));\n    }\n\n    // perform graphical import\n    importBpmnDiagram(self, definitions, bpmnDiagram).then(function (result) {\n      var warnings = result.warnings;\n      return resolve({\n        warnings: warnings\n      });\n    }).catch(function (err) {\n      return reject(err);\n    });\n  });\n});\n\n/**\r\n * The saveXML result.\r\n *\r\n * @typedef {Object} SaveXMLResult\r\n *\r\n * @property {string} xml\r\n */\n\n/**\r\n * Export the currently displayed BPMN 2.0 diagram as\r\n * a BPMN 2.0 XML document.\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During XML saving the viewer will fire life-cycle events:\r\n *\r\n *   * saveXML.start (before serialization)\r\n *   * saveXML.serialized (after xml generation)\r\n *   * saveXML.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {Object} [options] export options\r\n * @param {boolean} [options.format=false] output formatted XML\r\n * @param {boolean} [options.preamble=true] output preamble\r\n *\r\n * Returns {Promise<SaveXMLResult, Error>}\r\n */\nBaseViewer.prototype.saveXML = wrapForCompatibility(function saveXML(options) {\n  options = options || {};\n  var self = this;\n  var definitions = this._definitions;\n  return new Promise(function (resolve, reject) {\n    if (!definitions) {\n      var err = new Error('no definitions loaded');\n      return reject(err);\n    }\n\n    // allow to fiddle around with definitions\n    definitions = self._emit('saveXML.start', {\n      definitions: definitions\n    }) || definitions;\n    self._moddle.toXML(definitions, options).then(function (result) {\n      var xml = result.xml;\n      try {\n        xml = self._emit('saveXML.serialized', {\n          error: null,\n          xml: xml\n        }) || xml;\n        self._emit('saveXML.done', {\n          error: null,\n          xml: xml\n        });\n      } catch (e) {\n        console.error('error in saveXML life-cycle listener', e);\n      }\n      return resolve({\n        xml: xml\n      });\n    }).catch(function (err) {\n      return reject(err);\n    });\n  });\n});\n\n/**\r\n * The saveSVG result.\r\n *\r\n * @typedef {Object} SaveSVGResult\r\n *\r\n * @property {string} svg\r\n */\n\n/**\r\n * Export the currently displayed BPMN 2.0 diagram as\r\n * an SVG image.\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During SVG saving the viewer will fire life-cycle events:\r\n *\r\n *   * saveSVG.start (before serialization)\r\n *   * saveSVG.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {Object} [options]\r\n *\r\n * Returns {Promise<SaveSVGResult, Error>}\r\n */\nBaseViewer.prototype.saveSVG = wrapForCompatibility(function saveSVG(options) {\n  options = options || {};\n  var self = this;\n  return new Promise(function (resolve, reject) {\n    self._emit('saveSVG.start');\n    var svg, err;\n    try {\n      var canvas = self.get('canvas');\n      var contentNode = canvas.getDefaultLayer(),\n        defsNode = domQuery('defs', canvas._svg);\n      var contents = innerSVG(contentNode),\n        defs = defsNode ? '<defs>' + innerSVG(defsNode) + '</defs>' : '';\n      var bbox = contentNode.getBBox();\n      svg = '<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' + '<!-- created with bpmn-js / http://bpmn.io -->\\n' + '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' + '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' + 'width=\"' + bbox.width + '\" height=\"' + bbox.height + '\" ' + 'viewBox=\"' + bbox.x + ' ' + bbox.y + ' ' + bbox.width + ' ' + bbox.height + '\" version=\"1.1\">' + defs + contents + '</svg>';\n    } catch (e) {\n      err = e;\n    }\n    self._emit('saveSVG.done', {\n      error: err,\n      svg: svg\n    });\n    if (!err) {\n      return resolve({\n        svg: svg\n      });\n    }\n    return reject(err);\n  });\n});\n\n/**\r\n * Get a named diagram service.\r\n *\r\n * @example\r\n *\r\n * var elementRegistry = viewer.get('elementRegistry');\r\n * var startEventShape = elementRegistry.get('StartEvent_1');\r\n *\r\n * @param {string} name\r\n *\r\n * @return {Object} diagram service instance\r\n *\r\n * @method BaseViewer#get\r\n */\n\n/**\r\n * Invoke a function in the context of this viewer.\r\n *\r\n * @example\r\n *\r\n * viewer.invoke(function(elementRegistry) {\r\n *   var startEventShape = elementRegistry.get('StartEvent_1');\r\n * });\r\n *\r\n * @param {Function} fn to be invoked\r\n *\r\n * @return {Object} the functions return value\r\n *\r\n * @method BaseViewer#invoke\r\n */\n\nBaseViewer.prototype._setDefinitions = function (definitions) {\n  this._definitions = definitions;\n};\nBaseViewer.prototype.getModules = function () {\n  return this._modules;\n};\n\n/**\r\n * Remove all drawn elements from the viewer.\r\n *\r\n * After calling this method the viewer can still\r\n * be reused for opening another diagram.\r\n *\r\n * @method BaseViewer#clear\r\n */\nBaseViewer.prototype.clear = function () {\n  if (!this.getDefinitions()) {\n    // no diagram to clear\n    return;\n  }\n\n  // remove businessObject#di binding\n  //\n  // this is necessary, as we establish the bindings\n  // in the BpmnTreeWalker (and assume none are given\n  // on reimport)\n  this.get('elementRegistry').forEach(function (element) {\n    var bo = element.businessObject;\n    if (bo && bo.di) {\n      delete bo.di;\n    }\n  });\n\n  // remove drawn elements\n  Diagram.prototype.clear.call(this);\n};\n\n/**\r\n * Destroy the viewer instance and remove all its\r\n * remainders from the document tree.\r\n */\nBaseViewer.prototype.destroy = function () {\n  // diagram destroy\n  Diagram.prototype.destroy.call(this);\n\n  // dom detach\n  domRemove(this._container);\n};\n\n/**\r\n * Register an event listener\r\n *\r\n * Remove a previously added listener via {@link #off(event, callback)}.\r\n *\r\n * @param {string} event\r\n * @param {number} [priority]\r\n * @param {Function} callback\r\n * @param {Object} [that]\r\n */\nBaseViewer.prototype.on = function (event, priority, callback, target) {\n  return this.get('eventBus').on(event, priority, callback, target);\n};\n\n/**\r\n * De-register an event listener\r\n *\r\n * @param {string} event\r\n * @param {Function} callback\r\n */\nBaseViewer.prototype.off = function (event, callback) {\n  this.get('eventBus').off(event, callback);\n};\nBaseViewer.prototype.attachTo = function (parentNode) {\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n  parentNode.appendChild(this._container);\n  this._emit('attach', {});\n  this.get('canvas').resized();\n};\nBaseViewer.prototype.getDefinitions = function () {\n  return this._definitions;\n};\nBaseViewer.prototype.detach = function () {\n  var container = this._container,\n    parentNode = container.parentNode;\n  if (!parentNode) {\n    return;\n  }\n  this._emit('detach', {});\n  parentNode.removeChild(container);\n};\nBaseViewer.prototype._init = function (container, moddle, options) {\n  var baseModules = options.modules || this.getModules(),\n    additionalModules = options.additionalModules || [],\n    staticModules = [{\n      bpmnjs: ['value', this],\n      moddle: ['value', moddle]\n    }];\n  var diagramModules = [].concat(staticModules, baseModules, additionalModules);\n  var diagramOptions = assign(omit(options, ['additionalModules']), {\n    canvas: assign({}, options.canvas, {\n      container: container\n    }),\n    modules: diagramModules\n  });\n\n  // invoke diagram constructor\n  Diagram.call(this, diagramOptions);\n  if (options && options.container) {\n    this.attachTo(options.container);\n  }\n};\n\n/**\r\n * Emit an event on the underlying {@link EventBus}\r\n *\r\n * @param  {string} type\r\n * @param  {Object} event\r\n *\r\n * @return {Object} event processing result (if any)\r\n */\nBaseViewer.prototype._emit = function (type, event) {\n  return this.get('eventBus').fire(type, event);\n};\nBaseViewer.prototype._createContainer = function (options) {\n  var container = domify('<div class=\"bjs-container\"></div>');\n  assign(container.style, {\n    width: ensureUnit(options.width),\n    height: ensureUnit(options.height),\n    position: options.position\n  });\n  return container;\n};\nBaseViewer.prototype._createModdle = function (options) {\n  var moddleOptions = assign({}, this._moddleExtensions, options.moddleExtensions);\n  return new BpmnModdle(moddleOptions);\n};\nBaseViewer.prototype._modules = [];\n\n// helpers ///////////////\n\nfunction addWarningsToError(err, warningsAry) {\n  err.warnings = warningsAry;\n  return err;\n}\nfunction checkValidationError(err) {\n  // check if we can help the user by indicating wrong BPMN 2.0 xml\n  // (in case he or the exporting tool did not get that right)\n\n  var pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\n  var match = pattern.exec(err.message);\n  if (match) {\n    err.message = 'unparsable content <' + match[1] + '> detected; ' + 'this may indicate an invalid BPMN 2.0 diagram file' + match[2];\n  }\n  return err;\n}\nvar DEFAULT_OPTIONS = {\n  width: '100%',\n  height: '100%',\n  position: 'relative'\n};\n\n/**\r\n * Ensure the passed argument is a proper unit (defaulting to px)\r\n */\nfunction ensureUnit(val) {\n  return val + (isNumber(val) ? 'px' : '');\n}\n\n/**\r\n * Find BPMNDiagram in definitions by ID\r\n *\r\n * @param {ModdleElement<Definitions>} definitions\r\n * @param {string} diagramId\r\n *\r\n * @return {ModdleElement<BPMNDiagram>|null}\r\n */\nfunction findBPMNDiagram(definitions, diagramId) {\n  if (!diagramId) {\n    return null;\n  }\n  return find(definitions.diagrams, function (element) {\n    return element.id === diagramId;\n  }) || null;\n}\n\n/* <project-logo> */\n\nimport { open as openPoweredBy, BPMNIO_IMG, LINK_STYLES as BPMNIO_LINK_STYLES } from './util/PoweredByUtil';\nimport { event as domEvent } from 'min-dom';\n\n/**\r\n * Adds the project logo to the diagram container as\r\n * required by the bpmn.io license.\r\n *\r\n * @see http://bpmn.io/license\r\n *\r\n * @param {Element} container\r\n */\nfunction addProjectLogo(container) {\n  var img = BPMNIO_IMG;\n  var linkMarkup = '<a href=\"http://bpmn.io\" ' + 'target=\"_blank\" ' + 'class=\"bjs-powered-by\" ' + 'title=\"Powered by bpmn.io\" ' + 'style=\"position: absolute; bottom: 15px; right: 15px; z-index: 100; ' + BPMNIO_LINK_STYLES + '\">' + img + '</a>';\n  var linkElement = domify(linkMarkup);\n  container.appendChild(linkElement);\n  domEvent.bind(linkElement, 'click', function (event) {\n    openPoweredBy();\n    event.preventDefault();\n  });\n}\n\n/* </project-logo> */","map":{"version":3,"names":["assign","find","isNumber","omit","domify","query","domQuery","remove","domRemove","innerSVG","Diagram","BpmnModdle","inherits","importBpmnDiagram","wrapForCompatibility","BaseViewer","options","DEFAULT_OPTIONS","_moddle","_createModdle","_container","_createContainer","addProjectLogo","_init","prototype","importXML","xml","bpmnDiagram","self","ParseCompleteEvent","data","event","get","createEvent","Object","defineProperty","enumerable","console","warn","Error","warnings","references","elementsById","Promise","resolve","reject","_emit","fromXML","then","result","definitions","rootElement","parseWarnings","error","importDefinitions","allWarnings","concat","catch","err","addWarningsToError","checkValidationError","_setDefinitions","open","bpmnDiagramOrId","_definitions","err1","findBPMNDiagram","err2","clear","saveXML","toXML","e","saveSVG","svg","canvas","contentNode","getDefaultLayer","defsNode","_svg","contents","defs","bbox","getBBox","width","height","x","y","getModules","_modules","getDefinitions","forEach","element","bo","businessObject","di","call","destroy","on","priority","callback","target","off","attachTo","parentNode","detach","constructor","jquery","appendChild","resized","container","removeChild","moddle","baseModules","modules","additionalModules","staticModules","bpmnjs","diagramModules","diagramOptions","type","fire","style","ensureUnit","position","moddleOptions","_moddleExtensions","moddleExtensions","warningsAry","pattern","match","exec","message","val","diagramId","diagrams","id","openPoweredBy","BPMNIO_IMG","LINK_STYLES","BPMNIO_LINK_STYLES","domEvent","img","linkMarkup","linkElement","bind","preventDefault"],"sources":["C:/Users/sam/final/camunda-react/node_modules/bpmn-js/lib/BaseViewer.js"],"sourcesContent":["/**\r\n * The code in the <project-logo></project-logo> area\r\n * must not be changed.\r\n *\r\n * @see http://bpmn.io/license for more information.\r\n */\r\nimport {\r\n  assign,\r\n  find,\r\n  isNumber,\r\n  omit\r\n} from 'min-dash';\r\n\r\nimport {\r\n  domify,\r\n  query as domQuery,\r\n  remove as domRemove\r\n} from 'min-dom';\r\n\r\nimport {\r\n  innerSVG\r\n} from 'tiny-svg';\r\n\r\nimport Diagram from 'diagram-js';\r\nimport BpmnModdle from 'bpmn-moddle';\r\n\r\nimport inherits from 'inherits';\r\n\r\nimport {\r\n  importBpmnDiagram\r\n} from './import/Importer';\r\n\r\nimport {\r\n  wrapForCompatibility\r\n} from './util/CompatibilityUtil';\r\n\r\n/**\r\n * A base viewer for BPMN 2.0 diagrams.\r\n *\r\n * Have a look at {@link Viewer}, {@link NavigatedViewer} or {@link Modeler} for\r\n * bundles that include actual features.\r\n *\r\n * @param {Object} [options] configuration options to pass to the viewer\r\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\r\n * @param {string|number} [options.width] the width of the viewer\r\n * @param {string|number} [options.height] the height of the viewer\r\n * @param {Object} [options.moddleExtensions] extension packages to provide\r\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\r\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\r\n */\r\nexport default function BaseViewer(options) {\r\n\r\n  options = assign({}, DEFAULT_OPTIONS, options);\r\n\r\n  this._moddle = this._createModdle(options);\r\n\r\n  this._container = this._createContainer(options);\r\n\r\n  /* <project-logo> */\r\n\r\n  addProjectLogo(this._container);\r\n\r\n  /* </project-logo> */\r\n\r\n  this._init(this._container, this._moddle, options);\r\n}\r\n\r\ninherits(BaseViewer, Diagram);\r\n\r\n/**\r\n* The importXML result.\r\n*\r\n* @typedef {Object} ImportXMLResult\r\n*\r\n* @property {Array<string>} warnings\r\n*/\r\n\r\n/**\r\n* The importXML error.\r\n*\r\n* @typedef {Error} ImportXMLError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\r\n\r\n/**\r\n * Parse and render a BPMN 2.0 diagram.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During import the viewer will fire life-cycle events:\r\n *\r\n *   * import.parse.start (about to read model from xml)\r\n *   * import.parse.complete (model read; may have worked or not)\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *   * import.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {string} xml the BPMN 2.0 xml\r\n * @param {ModdleElement<BPMNDiagram>|string} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\r\n *\r\n * Returns {Promise<ImportXMLResult, ImportXMLError>}\r\n */\r\nBaseViewer.prototype.importXML = wrapForCompatibility(function importXML(xml, bpmnDiagram) {\r\n\r\n  var self = this;\r\n\r\n  function ParseCompleteEvent(data) {\r\n\r\n    var event = self.get('eventBus').createEvent(data);\r\n\r\n    // TODO(nikku): remove with future bpmn-js version\r\n    Object.defineProperty(event, 'context', {\r\n      enumerable: true,\r\n      get: function() {\r\n\r\n        console.warn(new Error(\r\n          'import.parse.complete <context> is deprecated ' +\r\n          'and will be removed in future library versions'\r\n        ));\r\n\r\n        return {\r\n          warnings: data.warnings,\r\n          references: data.references,\r\n          elementsById: data.elementsById\r\n        };\r\n      }\r\n    });\r\n\r\n    return event;\r\n  }\r\n\r\n  return new Promise(function(resolve, reject) {\r\n\r\n    // hook in pre-parse listeners +\r\n    // allow xml manipulation\r\n    xml = self._emit('import.parse.start', { xml: xml }) || xml;\r\n\r\n    self._moddle.fromXML(xml, 'bpmn:Definitions').then(function(result) {\r\n      var definitions = result.rootElement;\r\n      var references = result.references;\r\n      var parseWarnings = result.warnings;\r\n      var elementsById = result.elementsById;\r\n\r\n      // hook in post parse listeners +\r\n      // allow definitions manipulation\r\n      definitions = self._emit('import.parse.complete', ParseCompleteEvent({\r\n        error: null,\r\n        definitions: definitions,\r\n        elementsById: elementsById,\r\n        references: references,\r\n        warnings: parseWarnings\r\n      })) || definitions;\r\n\r\n      self.importDefinitions(definitions, bpmnDiagram).then(function(result) {\r\n        var allWarnings = [].concat(parseWarnings, result.warnings || []);\r\n\r\n        self._emit('import.done', { error: null, warnings: allWarnings });\r\n\r\n        return resolve({ warnings: allWarnings });\r\n      }).catch(function(err) {\r\n        var allWarnings = [].concat(parseWarnings, err.warnings || []);\r\n\r\n        self._emit('import.done', { error: err, warnings: allWarnings });\r\n\r\n        return reject(addWarningsToError(err, allWarnings));\r\n      });\r\n    }).catch(function(err) {\r\n\r\n      self._emit('import.parse.complete', {\r\n        error: err\r\n      });\r\n\r\n      err = checkValidationError(err);\r\n\r\n      self._emit('import.done', { error: err, warnings: err.warnings });\r\n\r\n      return reject(err);\r\n    });\r\n  });\r\n});\r\n\r\n/**\r\n* The importDefinitions result.\r\n*\r\n* @typedef {Object} ImportDefinitionsResult\r\n*\r\n* @property {Array<string>} warnings\r\n*/\r\n\r\n/**\r\n* The importDefinitions error.\r\n*\r\n* @typedef {Error} ImportDefinitionsError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\r\n\r\n/**\r\n * Import parsed definitions and render a BPMN 2.0 diagram.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During import the viewer will fire life-cycle events:\r\n *\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {ModdleElement<Definitions>} definitions parsed BPMN 2.0 definitions\r\n * @param {ModdleElement<BPMNDiagram>|string} [bpmnDiagram] BPMN diagram or id of diagram to render (if not provided, the first one will be rendered)\r\n *\r\n * Returns {Promise<ImportDefinitionsResult, ImportDefinitionsError>}\r\n */\r\nBaseViewer.prototype.importDefinitions = wrapForCompatibility(function importDefinitions(definitions, bpmnDiagram) {\r\n\r\n  var self = this;\r\n\r\n  return new Promise(function(resolve, reject) {\r\n\r\n    self._setDefinitions(definitions);\r\n\r\n    self.open(bpmnDiagram).then(function(result) {\r\n\r\n      var warnings = result.warnings;\r\n\r\n      return resolve({ warnings: warnings });\r\n    }).catch(function(err) {\r\n\r\n      return reject(err);\r\n    });\r\n  });\r\n});\r\n\r\n/**\r\n * The open result.\r\n *\r\n * @typedef {Object} OpenResult\r\n *\r\n * @property {Array<string>} warnings\r\n */\r\n\r\n/**\r\n* The open error.\r\n*\r\n* @typedef {Error} OpenError\r\n*\r\n* @property {Array<string>} warnings\r\n*/\r\n\r\n/**\r\n * Open diagram of previously imported XML.\r\n *\r\n * Once finished the viewer reports back the result to the\r\n * provided callback function with (err, warnings).\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During switch the viewer will fire life-cycle events:\r\n *\r\n *   * import.render.start (graphical import start)\r\n *   * import.render.complete (graphical import finished)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {string|ModdleElement<BPMNDiagram>} [bpmnDiagramOrId] id or the diagram to open\r\n *\r\n * Returns {Promise<OpenResult, OpenError>}\r\n */\r\nBaseViewer.prototype.open = wrapForCompatibility(function open(bpmnDiagramOrId) {\r\n\r\n  var definitions = this._definitions;\r\n  var bpmnDiagram = bpmnDiagramOrId;\r\n\r\n  var self = this;\r\n\r\n  return new Promise(function(resolve, reject) {\r\n    if (!definitions) {\r\n      var err1 = new Error('no XML imported');\r\n\r\n      return reject(addWarningsToError(err1, []));\r\n    }\r\n\r\n    if (typeof bpmnDiagramOrId === 'string') {\r\n      bpmnDiagram = findBPMNDiagram(definitions, bpmnDiagramOrId);\r\n\r\n      if (!bpmnDiagram) {\r\n        var err2 = new Error('BPMNDiagram <' + bpmnDiagramOrId + '> not found');\r\n\r\n        return reject(addWarningsToError(err2, []));\r\n      }\r\n    }\r\n\r\n    // clear existing rendered diagram\r\n    // catch synchronous exceptions during #clear()\r\n    try {\r\n      self.clear();\r\n    } catch (error) {\r\n\r\n      return reject(addWarningsToError(error, []));\r\n    }\r\n\r\n    // perform graphical import\r\n    importBpmnDiagram(self, definitions, bpmnDiagram).then(function(result) {\r\n\r\n      var warnings = result.warnings;\r\n\r\n      return resolve({ warnings: warnings });\r\n    }).catch(function(err) {\r\n\r\n      return reject(err);\r\n    });\r\n  });\r\n});\r\n\r\n/**\r\n * The saveXML result.\r\n *\r\n * @typedef {Object} SaveXMLResult\r\n *\r\n * @property {string} xml\r\n */\r\n\r\n/**\r\n * Export the currently displayed BPMN 2.0 diagram as\r\n * a BPMN 2.0 XML document.\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During XML saving the viewer will fire life-cycle events:\r\n *\r\n *   * saveXML.start (before serialization)\r\n *   * saveXML.serialized (after xml generation)\r\n *   * saveXML.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {Object} [options] export options\r\n * @param {boolean} [options.format=false] output formatted XML\r\n * @param {boolean} [options.preamble=true] output preamble\r\n *\r\n * Returns {Promise<SaveXMLResult, Error>}\r\n */\r\nBaseViewer.prototype.saveXML = wrapForCompatibility(function saveXML(options) {\r\n\r\n  options = options || {};\r\n\r\n  var self = this;\r\n\r\n  var definitions = this._definitions;\r\n\r\n  return new Promise(function(resolve, reject) {\r\n\r\n    if (!definitions) {\r\n      var err = new Error('no definitions loaded');\r\n\r\n      return reject(err);\r\n    }\r\n\r\n    // allow to fiddle around with definitions\r\n    definitions = self._emit('saveXML.start', {\r\n      definitions: definitions\r\n    }) || definitions;\r\n\r\n    self._moddle.toXML(definitions, options).then(function(result) {\r\n\r\n      var xml = result.xml;\r\n\r\n      try {\r\n        xml = self._emit('saveXML.serialized', {\r\n          error: null,\r\n          xml: xml\r\n        }) || xml;\r\n\r\n        self._emit('saveXML.done', {\r\n          error: null,\r\n          xml: xml\r\n        });\r\n      } catch (e) {\r\n        console.error('error in saveXML life-cycle listener', e);\r\n      }\r\n\r\n      return resolve({ xml: xml });\r\n    }).catch(function(err) {\r\n\r\n      return reject(err);\r\n    });\r\n  });\r\n});\r\n\r\n/**\r\n * The saveSVG result.\r\n *\r\n * @typedef {Object} SaveSVGResult\r\n *\r\n * @property {string} svg\r\n */\r\n\r\n/**\r\n * Export the currently displayed BPMN 2.0 diagram as\r\n * an SVG image.\r\n *\r\n * ## Life-Cycle Events\r\n *\r\n * During SVG saving the viewer will fire life-cycle events:\r\n *\r\n *   * saveSVG.start (before serialization)\r\n *   * saveSVG.done (everything done)\r\n *\r\n * You can use these events to hook into the life-cycle.\r\n *\r\n * @param {Object} [options]\r\n *\r\n * Returns {Promise<SaveSVGResult, Error>}\r\n */\r\nBaseViewer.prototype.saveSVG = wrapForCompatibility(function saveSVG(options) {\r\n\r\n  options = options || {};\r\n\r\n  var self = this;\r\n\r\n  return new Promise(function(resolve, reject) {\r\n\r\n    self._emit('saveSVG.start');\r\n\r\n    var svg, err;\r\n\r\n    try {\r\n      var canvas = self.get('canvas');\r\n\r\n      var contentNode = canvas.getDefaultLayer(),\r\n          defsNode = domQuery('defs', canvas._svg);\r\n\r\n      var contents = innerSVG(contentNode),\r\n          defs = defsNode ? '<defs>' + innerSVG(defsNode) + '</defs>' : '';\r\n\r\n      var bbox = contentNode.getBBox();\r\n\r\n      svg =\r\n        '<?xml version=\"1.0\" encoding=\"utf-8\"?>\\n' +\r\n        '<!-- created with bpmn-js / http://bpmn.io -->\\n' +\r\n        '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n' +\r\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" ' +\r\n             'width=\"' + bbox.width + '\" height=\"' + bbox.height + '\" ' +\r\n             'viewBox=\"' + bbox.x + ' ' + bbox.y + ' ' + bbox.width + ' ' + bbox.height + '\" version=\"1.1\">' +\r\n          defs + contents +\r\n        '</svg>';\r\n    } catch (e) {\r\n      err = e;\r\n    }\r\n\r\n    self._emit('saveSVG.done', {\r\n      error: err,\r\n      svg: svg\r\n    });\r\n\r\n    if (!err) {\r\n      return resolve({ svg: svg });\r\n    }\r\n\r\n    return reject(err);\r\n  });\r\n});\r\n\r\n/**\r\n * Get a named diagram service.\r\n *\r\n * @example\r\n *\r\n * var elementRegistry = viewer.get('elementRegistry');\r\n * var startEventShape = elementRegistry.get('StartEvent_1');\r\n *\r\n * @param {string} name\r\n *\r\n * @return {Object} diagram service instance\r\n *\r\n * @method BaseViewer#get\r\n */\r\n\r\n/**\r\n * Invoke a function in the context of this viewer.\r\n *\r\n * @example\r\n *\r\n * viewer.invoke(function(elementRegistry) {\r\n *   var startEventShape = elementRegistry.get('StartEvent_1');\r\n * });\r\n *\r\n * @param {Function} fn to be invoked\r\n *\r\n * @return {Object} the functions return value\r\n *\r\n * @method BaseViewer#invoke\r\n */\r\n\r\n\r\nBaseViewer.prototype._setDefinitions = function(definitions) {\r\n  this._definitions = definitions;\r\n};\r\n\r\nBaseViewer.prototype.getModules = function() {\r\n  return this._modules;\r\n};\r\n\r\n/**\r\n * Remove all drawn elements from the viewer.\r\n *\r\n * After calling this method the viewer can still\r\n * be reused for opening another diagram.\r\n *\r\n * @method BaseViewer#clear\r\n */\r\nBaseViewer.prototype.clear = function() {\r\n  if (!this.getDefinitions()) {\r\n\r\n    // no diagram to clear\r\n    return;\r\n  }\r\n\r\n  // remove businessObject#di binding\r\n  //\r\n  // this is necessary, as we establish the bindings\r\n  // in the BpmnTreeWalker (and assume none are given\r\n  // on reimport)\r\n  this.get('elementRegistry').forEach(function(element) {\r\n    var bo = element.businessObject;\r\n\r\n    if (bo && bo.di) {\r\n      delete bo.di;\r\n    }\r\n  });\r\n\r\n  // remove drawn elements\r\n  Diagram.prototype.clear.call(this);\r\n};\r\n\r\n/**\r\n * Destroy the viewer instance and remove all its\r\n * remainders from the document tree.\r\n */\r\nBaseViewer.prototype.destroy = function() {\r\n\r\n  // diagram destroy\r\n  Diagram.prototype.destroy.call(this);\r\n\r\n  // dom detach\r\n  domRemove(this._container);\r\n};\r\n\r\n/**\r\n * Register an event listener\r\n *\r\n * Remove a previously added listener via {@link #off(event, callback)}.\r\n *\r\n * @param {string} event\r\n * @param {number} [priority]\r\n * @param {Function} callback\r\n * @param {Object} [that]\r\n */\r\nBaseViewer.prototype.on = function(event, priority, callback, target) {\r\n  return this.get('eventBus').on(event, priority, callback, target);\r\n};\r\n\r\n/**\r\n * De-register an event listener\r\n *\r\n * @param {string} event\r\n * @param {Function} callback\r\n */\r\nBaseViewer.prototype.off = function(event, callback) {\r\n  this.get('eventBus').off(event, callback);\r\n};\r\n\r\nBaseViewer.prototype.attachTo = function(parentNode) {\r\n\r\n  if (!parentNode) {\r\n    throw new Error('parentNode required');\r\n  }\r\n\r\n  // ensure we detach from the\r\n  // previous, old parent\r\n  this.detach();\r\n\r\n  // unwrap jQuery if provided\r\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\r\n    parentNode = parentNode.get(0);\r\n  }\r\n\r\n  if (typeof parentNode === 'string') {\r\n    parentNode = domQuery(parentNode);\r\n  }\r\n\r\n  parentNode.appendChild(this._container);\r\n\r\n  this._emit('attach', {});\r\n\r\n  this.get('canvas').resized();\r\n};\r\n\r\nBaseViewer.prototype.getDefinitions = function() {\r\n  return this._definitions;\r\n};\r\n\r\nBaseViewer.prototype.detach = function() {\r\n\r\n  var container = this._container,\r\n      parentNode = container.parentNode;\r\n\r\n  if (!parentNode) {\r\n    return;\r\n  }\r\n\r\n  this._emit('detach', {});\r\n\r\n  parentNode.removeChild(container);\r\n};\r\n\r\nBaseViewer.prototype._init = function(container, moddle, options) {\r\n\r\n  var baseModules = options.modules || this.getModules(),\r\n      additionalModules = options.additionalModules || [],\r\n      staticModules = [\r\n        {\r\n          bpmnjs: [ 'value', this ],\r\n          moddle: [ 'value', moddle ]\r\n        }\r\n      ];\r\n\r\n  var diagramModules = [].concat(staticModules, baseModules, additionalModules);\r\n\r\n  var diagramOptions = assign(omit(options, [ 'additionalModules' ]), {\r\n    canvas: assign({}, options.canvas, { container: container }),\r\n    modules: diagramModules\r\n  });\r\n\r\n  // invoke diagram constructor\r\n  Diagram.call(this, diagramOptions);\r\n\r\n  if (options && options.container) {\r\n    this.attachTo(options.container);\r\n  }\r\n};\r\n\r\n/**\r\n * Emit an event on the underlying {@link EventBus}\r\n *\r\n * @param  {string} type\r\n * @param  {Object} event\r\n *\r\n * @return {Object} event processing result (if any)\r\n */\r\nBaseViewer.prototype._emit = function(type, event) {\r\n  return this.get('eventBus').fire(type, event);\r\n};\r\n\r\nBaseViewer.prototype._createContainer = function(options) {\r\n\r\n  var container = domify('<div class=\"bjs-container\"></div>');\r\n\r\n  assign(container.style, {\r\n    width: ensureUnit(options.width),\r\n    height: ensureUnit(options.height),\r\n    position: options.position\r\n  });\r\n\r\n  return container;\r\n};\r\n\r\nBaseViewer.prototype._createModdle = function(options) {\r\n  var moddleOptions = assign({}, this._moddleExtensions, options.moddleExtensions);\r\n\r\n  return new BpmnModdle(moddleOptions);\r\n};\r\n\r\nBaseViewer.prototype._modules = [];\r\n\r\n// helpers ///////////////\r\n\r\nfunction addWarningsToError(err, warningsAry) {\r\n  err.warnings = warningsAry;\r\n  return err;\r\n}\r\n\r\nfunction checkValidationError(err) {\r\n\r\n  // check if we can help the user by indicating wrong BPMN 2.0 xml\r\n  // (in case he or the exporting tool did not get that right)\r\n\r\n  var pattern = /unparsable content <([^>]+)> detected([\\s\\S]*)$/;\r\n  var match = pattern.exec(err.message);\r\n\r\n  if (match) {\r\n    err.message =\r\n      'unparsable content <' + match[1] + '> detected; ' +\r\n      'this may indicate an invalid BPMN 2.0 diagram file' + match[2];\r\n  }\r\n\r\n  return err;\r\n}\r\n\r\nvar DEFAULT_OPTIONS = {\r\n  width: '100%',\r\n  height: '100%',\r\n  position: 'relative'\r\n};\r\n\r\n\r\n/**\r\n * Ensure the passed argument is a proper unit (defaulting to px)\r\n */\r\nfunction ensureUnit(val) {\r\n  return val + (isNumber(val) ? 'px' : '');\r\n}\r\n\r\n\r\n/**\r\n * Find BPMNDiagram in definitions by ID\r\n *\r\n * @param {ModdleElement<Definitions>} definitions\r\n * @param {string} diagramId\r\n *\r\n * @return {ModdleElement<BPMNDiagram>|null}\r\n */\r\nfunction findBPMNDiagram(definitions, diagramId) {\r\n  if (!diagramId) {\r\n    return null;\r\n  }\r\n\r\n  return find(definitions.diagrams, function(element) {\r\n    return element.id === diagramId;\r\n  }) || null;\r\n}\r\n\r\n\r\n/* <project-logo> */\r\n\r\nimport {\r\n  open as openPoweredBy,\r\n  BPMNIO_IMG,\r\n  LINK_STYLES as BPMNIO_LINK_STYLES\r\n} from './util/PoweredByUtil';\r\n\r\nimport {\r\n  event as domEvent\r\n} from 'min-dom';\r\n\r\n/**\r\n * Adds the project logo to the diagram container as\r\n * required by the bpmn.io license.\r\n *\r\n * @see http://bpmn.io/license\r\n *\r\n * @param {Element} container\r\n */\r\nfunction addProjectLogo(container) {\r\n  var img = BPMNIO_IMG;\r\n\r\n  var linkMarkup =\r\n    '<a href=\"http://bpmn.io\" ' +\r\n       'target=\"_blank\" ' +\r\n       'class=\"bjs-powered-by\" ' +\r\n       'title=\"Powered by bpmn.io\" ' +\r\n       'style=\"position: absolute; bottom: 15px; right: 15px; z-index: 100; ' + BPMNIO_LINK_STYLES + '\">' +\r\n      img +\r\n    '</a>';\r\n\r\n  var linkElement = domify(linkMarkup);\r\n\r\n  container.appendChild(linkElement);\r\n\r\n  domEvent.bind(linkElement, 'click', function(event) {\r\n    openPoweredBy();\r\n\r\n    event.preventDefault();\r\n  });\r\n}\r\n\r\n/* </project-logo> */\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}